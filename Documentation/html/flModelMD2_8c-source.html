<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>funcLib: flModelMD2.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<h1>flModelMD2.c</h1><a href="flModelMD2_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#include "<a class="code" href="flGlobal_8h.html">flGlobal.h</a>"</span>
<a name="l00002"></a>00002 <span class="preprocessor">#if FL_MODEL_MD2 != 0</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span><span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00004"></a>00004 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00005"></a>00005 <span class="preprocessor">#include &lt;psprtc.h&gt;</span>
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 <span class="preprocessor">#if FL_INCLUDE_ALL_C == 0</span>
<a name="l00008"></a>00008 <span class="preprocessor"></span><span class="preprocessor">#include "<a class="code" href="flModelMD2_8h.html">flModelMD2.h</a>"</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include "<a class="code" href="flModel_8h.html">flModel.h</a>"</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include "<a class="code" href="flMemory_8h.html">flMemory.h</a>"</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include "<a class="code" href="flMath_8h.html">flMath.h</a>"</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include "<a class="code" href="flColor_8h.html">flColor.h</a>"</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include "<a class="code" href="flFile_8h.html">flFile.h</a>"</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include "<a class="code" href="flString_8h.html">flString.h</a>"</span>
<a name="l00015"></a>00015 
<a name="l00016"></a>00016 <span class="preprocessor">#include "<a class="code" href="flTexture_8h.html">flTexture.h</a>"</span>
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="preprocessor">#if FL_DEBUG != 0</span>
<a name="l00019"></a>00019 <span class="preprocessor"></span><span class="preprocessor">#include "<a class="code" href="flDebug_8h.html">flDebug.h</a>"</span>
<a name="l00020"></a>00020 <span class="preprocessor">#endif</span>
<a name="l00021"></a>00021 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00022"></a>00022 <span class="preprocessor"></span>
<a name="l00023"></a><a class="code" href="structmd2Header.html">00023</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00024"></a><a class="code" href="structmd2Header.html#2eb047b0cd6f016773f42c022389cffc">00024</a>      <span class="keywordtype">char</span> md2Ident[4];
<a name="l00025"></a><a class="code" href="structmd2Header.html#dde91619edd2aa08c17e48677e4c7e28">00025</a>      <span class="keywordtype">int</span>  md2Version;
<a name="l00026"></a><a class="code" href="structmd2Header.html#bd3e1e622d83e1fb7d6e8268936aab79">00026</a>      <span class="keywordtype">int</span>  md2SkinWidth;
<a name="l00027"></a><a class="code" href="structmd2Header.html#1d07f9f0b1606a5a52ed73d7dc419b16">00027</a>      <span class="keywordtype">int</span>  md2SkinHeight;
<a name="l00028"></a><a class="code" href="structmd2Header.html#8a0d627abf368f1987ce853c335b25b9">00028</a>      <span class="keywordtype">int</span>  md2FrameSize;
<a name="l00029"></a>00029      
<a name="l00030"></a><a class="code" href="structmd2Header.html#d51c64989b9d0a2e9d3b9a9e04e0d15b">00030</a>      <span class="keywordtype">int</span>  md2TextureCount;
<a name="l00031"></a><a class="code" href="structmd2Header.html#9777ae802f1e96d5ac7c1e547b8aa65b">00031</a>      <span class="keywordtype">int</span>  md2VertCount;
<a name="l00032"></a><a class="code" href="structmd2Header.html#cd583db74a07d20c4c5c8bff540d0bad">00032</a>      <span class="keywordtype">int</span>  md2TexVertCount;
<a name="l00033"></a><a class="code" href="structmd2Header.html#65810db04ae6fc922c9fac3305bf4cb2">00033</a>      <span class="keywordtype">int</span>  md2TriCount;
<a name="l00034"></a><a class="code" href="structmd2Header.html#5620662c6ad07235ee04897b7e8eedbe">00034</a>      <span class="keywordtype">int</span>  md2GlCmdCount;
<a name="l00035"></a><a class="code" href="structmd2Header.html#8cc7fa289334410225bad982548fda40">00035</a>      <span class="keywordtype">int</span>  md2FrameCount;
<a name="l00036"></a>00036 
<a name="l00037"></a><a class="code" href="structmd2Header.html#06a3bf40d5d8e0e6b06f5700e1a3956d">00037</a>      <span class="keywordtype">int</span>  md2TextureOffset;
<a name="l00038"></a><a class="code" href="structmd2Header.html#a38831e9cf97b745f528b2c123b8f090">00038</a>      <span class="keywordtype">int</span>  md2TexVertOffset;
<a name="l00039"></a><a class="code" href="structmd2Header.html#7ee5cd323121ae433c6bb3307b0eb4e9">00039</a>      <span class="keywordtype">int</span>  md2TriOffset;
<a name="l00040"></a><a class="code" href="structmd2Header.html#afe3b02bd33d0b4ba6e502d15e56bf58">00040</a>      <span class="keywordtype">int</span>  md2FrameOffset;
<a name="l00041"></a><a class="code" href="structmd2Header.html#b886e208846471c025a76b616c5016a5">00041</a>      <span class="keywordtype">int</span>  md2GlCmdOffset;
<a name="l00042"></a><a class="code" href="structmd2Header.html#12bca8aa60008c2c507cb5cd749f185d">00042</a>      <span class="keywordtype">int</span>  md2EndOffset;
<a name="l00043"></a>00043 } <a class="code" href="structmd2Header.html">md2Header</a>;
<a name="l00044"></a>00044 
<a name="l00045"></a><a class="code" href="structmd2Texture.html">00045</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00046"></a><a class="code" href="structmd2Texture.html#28111d460cc26070b007d00085782d8d">00046</a>      <span class="keywordtype">char</span> md2TextureName[64];
<a name="l00047"></a>00047 } <a class="code" href="structmd2Texture.html">md2Texture</a>;
<a name="l00048"></a>00048 
<a name="l00049"></a><a class="code" href="structmd2TexVert.html">00049</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00050"></a><a class="code" href="structmd2TexVert.html#8dcc61b6cc7df9317ddad0a29f6d835a">00050</a>      s16 md2TexVertU;
<a name="l00051"></a><a class="code" href="structmd2TexVert.html#230ef7123d2db4aa9fad7dd3e59514e1">00051</a>      s16 md2TexVertV;
<a name="l00052"></a>00052 } <a class="code" href="structmd2TexVert.html">md2TexVert</a>;
<a name="l00053"></a>00053 
<a name="l00054"></a><a class="code" href="structmd2Tri.html">00054</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00055"></a><a class="code" href="structmd2Tri.html#f2704861c273c266c4ab85c82a9f1ddf">00055</a>      u16 md2TriVerts[3];
<a name="l00056"></a><a class="code" href="structmd2Tri.html#a933a119f0c335ee43cb645c6f23a585">00056</a>      u16 md2TriTexVerts[3];
<a name="l00057"></a>00057 } <a class="code" href="structmd2Tri.html">md2Tri</a>;
<a name="l00058"></a>00058 
<a name="l00059"></a><a class="code" href="structmd2Vertex.html">00059</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00060"></a><a class="code" href="structmd2Vertex.html#c8f2998d1d6d1296474ecebb1e20e6cf">00060</a>      u8 md2VertexPos[3];
<a name="l00061"></a><a class="code" href="structmd2Vertex.html#794120e53aeee52ef76807ca777d5b37">00061</a>      u8 md2VertexNormal;
<a name="l00062"></a>00062 } <a class="code" href="structmd2Vertex.html">md2Vertex</a>;
<a name="l00063"></a>00063 
<a name="l00064"></a><a class="code" href="structmd2Frame.html">00064</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00065"></a><a class="code" href="structmd2Frame.html#cb2e6680b87f5fda3f3b30677dc560c8">00065</a>      <a class="code" href="flTypes_8h.html#3a47c621e6f02f2c15ee0f9ac6a4c9a1">vect3f</a>     md2FrameScale;
<a name="l00066"></a><a class="code" href="structmd2Frame.html#269edafc4d1a86bd68bea42fbf984723">00066</a>      <a class="code" href="flTypes_8h.html#3a47c621e6f02f2c15ee0f9ac6a4c9a1">vect3f</a>     md2FrameTranslate;
<a name="l00067"></a><a class="code" href="structmd2Frame.html#9c6ae978fdab67471b4541992f1e4664">00067</a>      <span class="keywordtype">char</span>       md2FrameName[16];
<a name="l00068"></a><a class="code" href="structmd2Frame.html#39265296662b9ac977f63cef9315f3aa">00068</a>      <a class="code" href="structmd2Vertex.html">md2Vertex</a>* md2FrameVerts;
<a name="l00069"></a>00069 } <a class="code" href="structmd2Frame.html">md2Frame</a>;
<a name="l00070"></a>00070 
<a name="l00071"></a><a class="code" href="structModel3dAnimatedMD2.html">00071</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00072"></a><a class="code" href="structModel3dAnimatedMD2.html#ed2383d4387b5cf609dc4a590a5e8e4b">00072</a>      u32         md2TextureCount;
<a name="l00073"></a><a class="code" href="structModel3dAnimatedMD2.html#0f02400bc89011b5279fbde8f49f756e">00073</a>      u32         md2TexVertCount;
<a name="l00074"></a><a class="code" href="structModel3dAnimatedMD2.html#fc7188cb2c13ea68efc2ebf627a484ad">00074</a>      u32         md2VertCount;
<a name="l00075"></a><a class="code" href="structModel3dAnimatedMD2.html#6d97a9a02aaf97abe329c4982fd40b32">00075</a>      u32         md2TriCount;
<a name="l00076"></a><a class="code" href="structModel3dAnimatedMD2.html#982b177f1e7eabc2eff5ff6dce05704e">00076</a>      u32         md2FrameCount;
<a name="l00077"></a>00077      
<a name="l00078"></a><a class="code" href="structModel3dAnimatedMD2.html#e59e1d97875561efa3760d1380f861b2">00078</a>      <a class="code" href="structTexture.html">Texture</a>**   md2Textures;
<a name="l00079"></a><a class="code" href="structModel3dAnimatedMD2.html#93a4f5c4330f3c40e7f1be861673c0e2">00079</a>      <a class="code" href="structmd2TexVert.html">md2TexVert</a>* md2TexVerts;
<a name="l00080"></a><a class="code" href="structModel3dAnimatedMD2.html#34b41f04ea13c17fb91e8274351e4430">00080</a>      <a class="code" href="structmd2Tri.html">md2Tri</a>*     md2Tris;
<a name="l00081"></a><a class="code" href="structModel3dAnimatedMD2.html#426ee1b3fd1199dcda98cc151f468749">00081</a>      <a class="code" href="structmd2Frame.html">md2Frame</a>*   md2Frames;
<a name="l00082"></a>00082 } <a class="code" href="structModel3dAnimatedMD2.html">Model3dAnimatedMD2</a>;
<a name="l00083"></a>00083 
<a name="l00084"></a><a class="code" href="flModelMD2_8h.html#44cbc511d53f5bac06b5abea496f5c29">00084</a> <a class="code" href="structModel3dAnimated.html">Model3dAnimated</a>* <a class="code" href="flModelMD2_8c.html#44cbc511d53f5bac06b5abea496f5c29">mdl3dAnimLoadMD2</a>(<span class="keywordtype">char</span>* inPath) {
<a name="l00085"></a>00085      <a class="code" href="structModel3dAnimatedMD2.html">Model3dAnimatedMD2</a>* tempModel = (<a class="code" href="structModel3dAnimatedMD2.html">Model3dAnimatedMD2</a>*)<a class="code" href="flMemory_8h.html#61b12aace9141e9aa9a733ab7e7d8f1c">memAlloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="structModel3dAnimatedMD2.html">Model3dAnimatedMD2</a>));
<a name="l00086"></a>00086      <span class="keywordflow">if</span>(!tempModel) {
<a name="l00087"></a>00087 <span class="preprocessor">          #if FL_DEBUG_WARNING != 0</span>
<a name="l00088"></a>00088 <span class="preprocessor"></span>          <a class="code" href="flDebug_8h.html#a122223db39f9f6ab0773adbf5de1a97">debugWarning</a>(<span class="stringliteral">"Can't create md2 model struct.\nProbably out of memory."</span>);
<a name="l00089"></a>00089 <span class="preprocessor">          #endif</span>
<a name="l00090"></a>00090 <span class="preprocessor"></span>          <span class="keywordflow">return</span> <a class="code" href="flTypes_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00091"></a>00091      }
<a name="l00092"></a>00092      <a class="code" href="structModel3dAnimated.html">Model3dAnimated</a>* tempOut = (<a class="code" href="structModel3dAnimated.html">Model3dAnimated</a>*)<a class="code" href="flMemory_8h.html#61b12aace9141e9aa9a733ab7e7d8f1c">memAlloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="structModel3dAnimated.html">Model3dAnimated</a>));
<a name="l00093"></a>00093      <span class="keywordflow">if</span>(!tempOut) {
<a name="l00094"></a>00094           <a class="code" href="flMemory_8h.html#b5a200b09037e42c940e59383787470c">memFree</a>(tempModel);
<a name="l00095"></a>00095 <span class="preprocessor">          #if FL_DEBUG_WARNING != 0</span>
<a name="l00096"></a>00096 <span class="preprocessor"></span>          <a class="code" href="flDebug_8h.html#a122223db39f9f6ab0773adbf5de1a97">debugWarning</a>(<span class="stringliteral">"Can't create model struct.\nProbably out of memory."</span>);
<a name="l00097"></a>00097 <span class="preprocessor">          #endif</span>
<a name="l00098"></a>00098 <span class="preprocessor"></span>          <span class="keywordflow">return</span> <a class="code" href="flTypes_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00099"></a>00099      }
<a name="l00100"></a>00100      tempOut-&gt;<a class="code" href="structModel3dAnimated.html#cd53e519d9b998deef1cfae4b7efbf16">mdlType</a> = <a class="code" href="flModel_8h.html#4ba59df590fcbf41f4d7961925c77c19">MODEL_ANIM_TYPE_MD2</a>;
<a name="l00101"></a>00101      tempOut-&gt;<a class="code" href="structModel3dAnimated.html#2e681d796bb8a1e4cf48c6d7e038a5df">mdlData</a> = (<span class="keywordtype">void</span>*)tempModel;
<a name="l00102"></a>00102      
<a name="l00103"></a>00103      
<a name="l00104"></a>00104      <a class="code" href="structmd2Header.html">md2Header</a> tempHeader;
<a name="l00105"></a>00105      <span class="keywordtype">int</span> i, j;
<a name="l00106"></a>00106      
<a name="l00107"></a>00107 <span class="preprocessor">     #if FL_FILE != 0</span>
<a name="l00108"></a>00108 <span class="preprocessor"></span>     <a class="code" href="structFile.html">File</a>* tempFile = <a class="code" href="flFile_8c.html#c93941480776a7835fc0b7eec7ebea85">fileOpen</a>(inPath, <a class="code" href="flFile_8h.html#01a82af4b478b1d490bf495e26c319d8">FILE_MODE_READ</a> | <a class="code" href="flFile_8h.html#0f396696b14f2798b74cab1408c7f554">FILE_MODE_BINARY</a>);
<a name="l00109"></a>00109 <span class="preprocessor">     #else</span>
<a name="l00110"></a>00110 <span class="preprocessor"></span>     FILE* tempFile = fopen(inPath, <span class="stringliteral">"rb"</span>);
<a name="l00111"></a>00111 <span class="preprocessor">     #endif</span>
<a name="l00112"></a>00112 <span class="preprocessor"></span>     
<a name="l00113"></a>00113      <a class="code" href="flFile_8c.html#bd15952bb98932926572c806c3b3cf20">fileRead</a>(tempHeader.<a class="code" href="structmd2Header.html#2eb047b0cd6f016773f42c022389cffc">md2Ident</a>, 4, tempFile);
<a name="l00114"></a>00114      <a class="code" href="flFile_8c.html#bd15952bb98932926572c806c3b3cf20">fileRead</a>(&amp;tempHeader.<a class="code" href="structmd2Header.html#dde91619edd2aa08c17e48677e4c7e28">md2Version</a>, 4, tempFile);
<a name="l00115"></a>00115      <span class="keywordflow">if</span>(strncmp(tempHeader.<a class="code" href="structmd2Header.html#2eb047b0cd6f016773f42c022389cffc">md2Ident</a>, <span class="stringliteral">"IDP2"</span>, 4) || (tempHeader.<a class="code" href="structmd2Header.html#dde91619edd2aa08c17e48677e4c7e28">md2Version</a> != 8)) {
<a name="l00116"></a>00116           <a class="code" href="flFile_8c.html#bdd17f626a43391a546883c7a0544dc3">fileClose</a>(tempFile);
<a name="l00117"></a>00117           <a class="code" href="flMemory_8h.html#b5a200b09037e42c940e59383787470c">memFree</a>(tempModel);
<a name="l00118"></a>00118           <a class="code" href="flMemory_8h.html#b5a200b09037e42c940e59383787470c">memFree</a>(tempOut);
<a name="l00119"></a>00119 <span class="preprocessor">          #if FL_DEBUG_WARNING != 0</span>
<a name="l00120"></a>00120 <span class="preprocessor"></span>          <a class="code" href="flDebug_8h.html#a122223db39f9f6ab0773adbf5de1a97">debugWarning</a>(<span class="stringliteral">"Only IDP2 version 8 md2 files are supported."</span>);
<a name="l00121"></a>00121 <span class="preprocessor">          #endif</span>
<a name="l00122"></a>00122 <span class="preprocessor"></span>          <span class="keywordflow">return</span> <a class="code" href="flTypes_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00123"></a>00123      }
<a name="l00124"></a>00124      <a class="code" href="flFile_8c.html#bd15952bb98932926572c806c3b3cf20">fileRead</a>(&amp;tempHeader.<a class="code" href="structmd2Header.html#bd3e1e622d83e1fb7d6e8268936aab79">md2SkinWidth</a>, 4, tempFile);
<a name="l00125"></a>00125      <a class="code" href="flFile_8c.html#bd15952bb98932926572c806c3b3cf20">fileRead</a>(&amp;tempHeader.<a class="code" href="structmd2Header.html#1d07f9f0b1606a5a52ed73d7dc419b16">md2SkinHeight</a>, 4, tempFile);
<a name="l00126"></a>00126      <a class="code" href="flFile_8c.html#bd15952bb98932926572c806c3b3cf20">fileRead</a>(&amp;tempHeader.<a class="code" href="structmd2Header.html#8a0d627abf368f1987ce853c335b25b9">md2FrameSize</a>, 4, tempFile);
<a name="l00127"></a>00127      <a class="code" href="flFile_8c.html#bd15952bb98932926572c806c3b3cf20">fileRead</a>(&amp;tempHeader.<a class="code" href="structmd2Header.html#d51c64989b9d0a2e9d3b9a9e04e0d15b">md2TextureCount</a>, 4, tempFile);
<a name="l00128"></a>00128      <a class="code" href="flFile_8c.html#bd15952bb98932926572c806c3b3cf20">fileRead</a>(&amp;tempHeader.<a class="code" href="structmd2Header.html#9777ae802f1e96d5ac7c1e547b8aa65b">md2VertCount</a>, 4, tempFile);
<a name="l00129"></a>00129      <a class="code" href="flFile_8c.html#bd15952bb98932926572c806c3b3cf20">fileRead</a>(&amp;tempHeader.<a class="code" href="structmd2Header.html#cd583db74a07d20c4c5c8bff540d0bad">md2TexVertCount</a>, 4, tempFile);
<a name="l00130"></a>00130      <a class="code" href="flFile_8c.html#bd15952bb98932926572c806c3b3cf20">fileRead</a>(&amp;tempHeader.<a class="code" href="structmd2Header.html#65810db04ae6fc922c9fac3305bf4cb2">md2TriCount</a>, 4, tempFile);
<a name="l00131"></a>00131      <a class="code" href="flFile_8c.html#bd15952bb98932926572c806c3b3cf20">fileRead</a>(&amp;tempHeader.<a class="code" href="structmd2Header.html#5620662c6ad07235ee04897b7e8eedbe">md2GlCmdCount</a>, 4, tempFile);
<a name="l00132"></a>00132      <a class="code" href="flFile_8c.html#bd15952bb98932926572c806c3b3cf20">fileRead</a>(&amp;tempHeader.<a class="code" href="structmd2Header.html#8cc7fa289334410225bad982548fda40">md2FrameCount</a>, 4, tempFile);
<a name="l00133"></a>00133      <a class="code" href="flFile_8c.html#bd15952bb98932926572c806c3b3cf20">fileRead</a>(&amp;tempHeader.<a class="code" href="structmd2Header.html#06a3bf40d5d8e0e6b06f5700e1a3956d">md2TextureOffset</a>, 4, tempFile);
<a name="l00134"></a>00134      <a class="code" href="flFile_8c.html#bd15952bb98932926572c806c3b3cf20">fileRead</a>(&amp;tempHeader.<a class="code" href="structmd2Header.html#a38831e9cf97b745f528b2c123b8f090">md2TexVertOffset</a>, 4, tempFile);
<a name="l00135"></a>00135      <a class="code" href="flFile_8c.html#bd15952bb98932926572c806c3b3cf20">fileRead</a>(&amp;tempHeader.<a class="code" href="structmd2Header.html#7ee5cd323121ae433c6bb3307b0eb4e9">md2TriOffset</a>, 4, tempFile);
<a name="l00136"></a>00136      <a class="code" href="flFile_8c.html#bd15952bb98932926572c806c3b3cf20">fileRead</a>(&amp;tempHeader.<a class="code" href="structmd2Header.html#afe3b02bd33d0b4ba6e502d15e56bf58">md2FrameOffset</a>, 4, tempFile);
<a name="l00137"></a>00137      <a class="code" href="flFile_8c.html#bd15952bb98932926572c806c3b3cf20">fileRead</a>(&amp;tempHeader.<a class="code" href="structmd2Header.html#b886e208846471c025a76b616c5016a5">md2GlCmdOffset</a>, 4, tempFile);
<a name="l00138"></a>00138      <a class="code" href="flFile_8c.html#bd15952bb98932926572c806c3b3cf20">fileRead</a>(&amp;tempHeader.<a class="code" href="structmd2Header.html#12bca8aa60008c2c507cb5cd749f185d">md2EndOffset</a>, 4, tempFile);
<a name="l00139"></a>00139      
<a name="l00140"></a>00140      tempModel-&gt;<a class="code" href="structModel3dAnimatedMD2.html#ed2383d4387b5cf609dc4a590a5e8e4b">md2TextureCount</a> = tempHeader.<a class="code" href="structmd2Header.html#d51c64989b9d0a2e9d3b9a9e04e0d15b">md2TextureCount</a>;
<a name="l00141"></a>00141      tempModel-&gt;<a class="code" href="structModel3dAnimatedMD2.html#0f02400bc89011b5279fbde8f49f756e">md2TexVertCount</a> = tempHeader.<a class="code" href="structmd2Header.html#cd583db74a07d20c4c5c8bff540d0bad">md2TexVertCount</a>;
<a name="l00142"></a>00142      tempModel-&gt;<a class="code" href="structModel3dAnimatedMD2.html#fc7188cb2c13ea68efc2ebf627a484ad">md2VertCount</a> = tempHeader.<a class="code" href="structmd2Header.html#9777ae802f1e96d5ac7c1e547b8aa65b">md2VertCount</a>;
<a name="l00143"></a>00143      tempModel-&gt;<a class="code" href="structModel3dAnimatedMD2.html#6d97a9a02aaf97abe329c4982fd40b32">md2TriCount</a> = tempHeader.<a class="code" href="structmd2Header.html#65810db04ae6fc922c9fac3305bf4cb2">md2TriCount</a>;
<a name="l00144"></a>00144      tempModel-&gt;<a class="code" href="structModel3dAnimatedMD2.html#982b177f1e7eabc2eff5ff6dce05704e">md2FrameCount</a> = tempHeader.<a class="code" href="structmd2Header.html#8cc7fa289334410225bad982548fda40">md2FrameCount</a>;
<a name="l00145"></a>00145      
<a name="l00146"></a>00146      u32 tempSize = (<span class="keyword">sizeof</span>(<a class="code" href="structTexture.html">Texture</a>*) * tempHeader.<a class="code" href="structmd2Header.html#d51c64989b9d0a2e9d3b9a9e04e0d15b">md2TextureCount</a>);
<a name="l00147"></a>00147      tempSize += (<span class="keyword">sizeof</span>(<a class="code" href="structmd2TexVert.html">md2TexVert</a>) * tempHeader.<a class="code" href="structmd2Header.html#cd583db74a07d20c4c5c8bff540d0bad">md2TexVertCount</a>);
<a name="l00148"></a>00148      tempSize += (<span class="keyword">sizeof</span>(<a class="code" href="structmd2Tri.html">md2Tri</a>) * tempHeader.<a class="code" href="structmd2Header.html#65810db04ae6fc922c9fac3305bf4cb2">md2TriCount</a>);
<a name="l00149"></a>00149      tempSize += (<span class="keyword">sizeof</span>(<a class="code" href="structmd2Frame.html">md2Frame</a>) * tempHeader.<a class="code" href="structmd2Header.html#8cc7fa289334410225bad982548fda40">md2FrameCount</a>);
<a name="l00150"></a>00150      tempSize += (<span class="keyword">sizeof</span>(<a class="code" href="structmd2Vertex.html">md2Vertex</a>) * tempHeader.<a class="code" href="structmd2Header.html#9777ae802f1e96d5ac7c1e547b8aa65b">md2VertCount</a> * tempHeader.<a class="code" href="structmd2Header.html#8cc7fa289334410225bad982548fda40">md2FrameCount</a>);
<a name="l00151"></a>00151      <span class="keywordtype">void</span>* tempBlockAlloc = <a class="code" href="flMemory_8h.html#61b12aace9141e9aa9a733ab7e7d8f1c">memAlloc</a>(tempSize);
<a name="l00152"></a>00152      <span class="keywordflow">if</span>(!tempBlockAlloc) {
<a name="l00153"></a>00153           <a class="code" href="flMemory_8h.html#b5a200b09037e42c940e59383787470c">memFree</a>(tempOut);
<a name="l00154"></a>00154           <a class="code" href="flMemory_8h.html#b5a200b09037e42c940e59383787470c">memFree</a>(tempModel);
<a name="l00155"></a>00155           <a class="code" href="flFile_8c.html#bdd17f626a43391a546883c7a0544dc3">fileClose</a>(tempFile);
<a name="l00156"></a>00156 <span class="preprocessor">          #if FL_DEBUG_WARNING != 0</span>
<a name="l00157"></a>00157 <span class="preprocessor"></span>          <a class="code" href="flDebug_8h.html#a122223db39f9f6ab0773adbf5de1a97">debugWarning</a>(<span class="stringliteral">"Can't allocate memory for model data.\nProbably out of memory."</span>);
<a name="l00158"></a>00158 <span class="preprocessor">          #endif</span>
<a name="l00159"></a>00159 <span class="preprocessor"></span>          <span class="keywordflow">return</span> <a class="code" href="flTypes_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00160"></a>00160      }
<a name="l00161"></a>00161      
<a name="l00162"></a>00162      tempModel-&gt;<a class="code" href="structModel3dAnimatedMD2.html#e59e1d97875561efa3760d1380f861b2">md2Textures</a> = (<a class="code" href="structTexture.html">Texture</a>**)tempBlockAlloc;
<a name="l00163"></a>00163      u32 tempOffset = (<span class="keyword">sizeof</span>(<a class="code" href="structTexture.html">Texture</a>*) * tempHeader.<a class="code" href="structmd2Header.html#d51c64989b9d0a2e9d3b9a9e04e0d15b">md2TextureCount</a>);
<a name="l00164"></a>00164      tempModel-&gt;<a class="code" href="structModel3dAnimatedMD2.html#93a4f5c4330f3c40e7f1be861673c0e2">md2TexVerts</a> = (<a class="code" href="structmd2TexVert.html">md2TexVert</a>*)((u32)tempBlockAlloc + tempOffset);
<a name="l00165"></a>00165      tempOffset += (<span class="keyword">sizeof</span>(<a class="code" href="structmd2TexVert.html">md2TexVert</a>) * tempHeader.<a class="code" href="structmd2Header.html#cd583db74a07d20c4c5c8bff540d0bad">md2TexVertCount</a>);
<a name="l00166"></a>00166      tempModel-&gt;<a class="code" href="structModel3dAnimatedMD2.html#34b41f04ea13c17fb91e8274351e4430">md2Tris</a> = (<a class="code" href="structmd2Tri.html">md2Tri</a>*)((u32)tempBlockAlloc + tempOffset);
<a name="l00167"></a>00167      tempOffset += (<span class="keyword">sizeof</span>(<a class="code" href="structmd2Tri.html">md2Tri</a>) * tempHeader.<a class="code" href="structmd2Header.html#cd583db74a07d20c4c5c8bff540d0bad">md2TexVertCount</a>);
<a name="l00168"></a>00168      tempModel-&gt;<a class="code" href="structModel3dAnimatedMD2.html#426ee1b3fd1199dcda98cc151f468749">md2Frames</a> = (<a class="code" href="structmd2Frame.html">md2Frame</a>*)((u32)tempBlockAlloc + tempOffset);
<a name="l00169"></a>00169      tempOffset += (<span class="keyword">sizeof</span>(<a class="code" href="structmd2Frame.html">md2Frame</a>) * tempHeader.<a class="code" href="structmd2Header.html#8cc7fa289334410225bad982548fda40">md2FrameCount</a>);
<a name="l00170"></a>00170 
<a name="l00171"></a>00171      <span class="keywordtype">char</span> tempTexPath[64];     
<a name="l00172"></a>00172      <a class="code" href="flFile_8c.html#e5232070b4bd85cfcbeee00f4e8e32a4">fileSeek</a>(tempFile, tempHeader.<a class="code" href="structmd2Header.html#06a3bf40d5d8e0e6b06f5700e1a3956d">md2TextureOffset</a>, <a class="code" href="flFile_8h.html#e2c4c68b8f9b63358f8c8f32b77ecb09">FILE_SEEK_SET</a>);
<a name="l00173"></a>00173      <span class="keywordflow">for</span>(i = 0; i &lt; tempHeader.<a class="code" href="structmd2Header.html#d51c64989b9d0a2e9d3b9a9e04e0d15b">md2TextureCount</a>; i++) {
<a name="l00174"></a>00174           <a class="code" href="flFile_8c.html#bd15952bb98932926572c806c3b3cf20">fileRead</a>(tempTexPath, 64, tempFile);
<a name="l00175"></a>00175           tempModel-&gt;<a class="code" href="structModel3dAnimatedMD2.html#e59e1d97875561efa3760d1380f861b2">md2Textures</a>[i] = <a class="code" href="flTexture_8c.html#723acca77c2b47c9f8f9d1064ee509ee">texLoad</a>(tempTexPath);
<a name="l00176"></a>00176           <span class="keywordflow">if</span>(!tempModel-&gt;<a class="code" href="structModel3dAnimatedMD2.html#e59e1d97875561efa3760d1380f861b2">md2Textures</a>[i]) {
<a name="l00177"></a>00177                <a class="code" href="flModel_8c.html#505d5a999b50546385c81e59ed9a16c8">mdl3dAnimFree</a>(tempOut);
<a name="l00178"></a>00178                <a class="code" href="flFile_8c.html#bdd17f626a43391a546883c7a0544dc3">fileClose</a>(tempFile);
<a name="l00179"></a>00179 <span class="preprocessor">               #if FL_DEBUG_WARNING != 0</span>
<a name="l00180"></a>00180 <span class="preprocessor"></span>               <a class="code" href="flDebug_8h.html#a122223db39f9f6ab0773adbf5de1a97">debugWarning</a>(<span class="stringliteral">"Can't open texture file in MD2."</span>);
<a name="l00181"></a>00181 <span class="preprocessor">               #endif</span>
<a name="l00182"></a>00182 <span class="preprocessor"></span>               <span class="keywordflow">return</span> <a class="code" href="flTypes_8h.html#070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00183"></a>00183           }
<a name="l00184"></a>00184      }
<a name="l00185"></a>00185      
<a name="l00186"></a>00186      <a class="code" href="flFile_8c.html#e5232070b4bd85cfcbeee00f4e8e32a4">fileSeek</a>(tempFile, tempHeader.<a class="code" href="structmd2Header.html#a38831e9cf97b745f528b2c123b8f090">md2TexVertOffset</a>, <a class="code" href="flFile_8h.html#e2c4c68b8f9b63358f8c8f32b77ecb09">FILE_SEEK_SET</a>);
<a name="l00187"></a>00187      <span class="keywordflow">for</span>(i = 0; i &lt; tempHeader.<a class="code" href="structmd2Header.html#cd583db74a07d20c4c5c8bff540d0bad">md2TexVertCount</a>; i++) {
<a name="l00188"></a>00188           <a class="code" href="flFile_8c.html#bd15952bb98932926572c806c3b3cf20">fileRead</a>(&amp;tempModel-&gt;<a class="code" href="structModel3dAnimatedMD2.html#93a4f5c4330f3c40e7f1be861673c0e2">md2TexVerts</a>[i].<a class="code" href="structmd2TexVert.html#8dcc61b6cc7df9317ddad0a29f6d835a">md2TexVertU</a>, 2, tempFile);
<a name="l00189"></a>00189           <a class="code" href="flFile_8c.html#bd15952bb98932926572c806c3b3cf20">fileRead</a>(&amp;tempModel-&gt;<a class="code" href="structModel3dAnimatedMD2.html#93a4f5c4330f3c40e7f1be861673c0e2">md2TexVerts</a>[i].<a class="code" href="structmd2TexVert.html#230ef7123d2db4aa9fad7dd3e59514e1">md2TexVertV</a>, 2, tempFile);
<a name="l00190"></a>00190      }
<a name="l00191"></a>00191      
<a name="l00192"></a>00192      <a class="code" href="flFile_8c.html#e5232070b4bd85cfcbeee00f4e8e32a4">fileSeek</a>(tempFile, tempHeader.<a class="code" href="structmd2Header.html#7ee5cd323121ae433c6bb3307b0eb4e9">md2TriOffset</a>, <a class="code" href="flFile_8h.html#e2c4c68b8f9b63358f8c8f32b77ecb09">FILE_SEEK_SET</a>);
<a name="l00193"></a>00193      <span class="keywordflow">for</span>(i = 0; i &lt; tempHeader.<a class="code" href="structmd2Header.html#65810db04ae6fc922c9fac3305bf4cb2">md2TriCount</a>; i++) {
<a name="l00194"></a>00194           <span class="keywordflow">for</span>(j = 0; j &lt; 3; j++)
<a name="l00195"></a>00195                <a class="code" href="flFile_8c.html#bd15952bb98932926572c806c3b3cf20">fileRead</a>(&amp;tempModel-&gt;<a class="code" href="structModel3dAnimatedMD2.html#34b41f04ea13c17fb91e8274351e4430">md2Tris</a>[i].<a class="code" href="structmd2Tri.html#f2704861c273c266c4ab85c82a9f1ddf">md2TriVerts</a>[j], 2, tempFile);
<a name="l00196"></a>00196           <span class="keywordflow">for</span>(j = 0; j &lt; 3; j++)
<a name="l00197"></a>00197                <a class="code" href="flFile_8c.html#bd15952bb98932926572c806c3b3cf20">fileRead</a>(&amp;tempModel-&gt;<a class="code" href="structModel3dAnimatedMD2.html#34b41f04ea13c17fb91e8274351e4430">md2Tris</a>[i].<a class="code" href="structmd2Tri.html#a933a119f0c335ee43cb645c6f23a585">md2TriTexVerts</a>[j], 2, tempFile);
<a name="l00198"></a>00198      }
<a name="l00199"></a>00199 
<a name="l00200"></a>00200      <a class="code" href="flFile_8c.html#e5232070b4bd85cfcbeee00f4e8e32a4">fileSeek</a>(tempFile, tempHeader.<a class="code" href="structmd2Header.html#afe3b02bd33d0b4ba6e502d15e56bf58">md2FrameOffset</a>, <a class="code" href="flFile_8h.html#e2c4c68b8f9b63358f8c8f32b77ecb09">FILE_SEEK_SET</a>);
<a name="l00201"></a>00201      <span class="keywordflow">for</span>(i = 0; i &lt; tempHeader.<a class="code" href="structmd2Header.html#8cc7fa289334410225bad982548fda40">md2FrameCount</a>; i++) {
<a name="l00202"></a>00202           <a class="code" href="flFile_8c.html#bd15952bb98932926572c806c3b3cf20">fileRead</a>(&amp;tempModel-&gt;<a class="code" href="structModel3dAnimatedMD2.html#426ee1b3fd1199dcda98cc151f468749">md2Frames</a>[i].<a class="code" href="structmd2Frame.html#cb2e6680b87f5fda3f3b30677dc560c8">md2FrameScale</a>.x, 4, tempFile);
<a name="l00203"></a>00203           <a class="code" href="flFile_8c.html#bd15952bb98932926572c806c3b3cf20">fileRead</a>(&amp;tempModel-&gt;<a class="code" href="structModel3dAnimatedMD2.html#426ee1b3fd1199dcda98cc151f468749">md2Frames</a>[i].<a class="code" href="structmd2Frame.html#cb2e6680b87f5fda3f3b30677dc560c8">md2FrameScale</a>.y, 4, tempFile);
<a name="l00204"></a>00204           <a class="code" href="flFile_8c.html#bd15952bb98932926572c806c3b3cf20">fileRead</a>(&amp;tempModel-&gt;<a class="code" href="structModel3dAnimatedMD2.html#426ee1b3fd1199dcda98cc151f468749">md2Frames</a>[i].<a class="code" href="structmd2Frame.html#cb2e6680b87f5fda3f3b30677dc560c8">md2FrameScale</a>.z, 4, tempFile);
<a name="l00205"></a>00205           <a class="code" href="flFile_8c.html#bd15952bb98932926572c806c3b3cf20">fileRead</a>(&amp;tempModel-&gt;<a class="code" href="structModel3dAnimatedMD2.html#426ee1b3fd1199dcda98cc151f468749">md2Frames</a>[i].<a class="code" href="structmd2Frame.html#269edafc4d1a86bd68bea42fbf984723">md2FrameTranslate</a>.x, 4, tempFile);
<a name="l00206"></a>00206           <a class="code" href="flFile_8c.html#bd15952bb98932926572c806c3b3cf20">fileRead</a>(&amp;tempModel-&gt;<a class="code" href="structModel3dAnimatedMD2.html#426ee1b3fd1199dcda98cc151f468749">md2Frames</a>[i].<a class="code" href="structmd2Frame.html#269edafc4d1a86bd68bea42fbf984723">md2FrameTranslate</a>.x, 4, tempFile);
<a name="l00207"></a>00207           <a class="code" href="flFile_8c.html#bd15952bb98932926572c806c3b3cf20">fileRead</a>(&amp;tempModel-&gt;<a class="code" href="structModel3dAnimatedMD2.html#426ee1b3fd1199dcda98cc151f468749">md2Frames</a>[i].<a class="code" href="structmd2Frame.html#269edafc4d1a86bd68bea42fbf984723">md2FrameTranslate</a>.x, 4, tempFile);
<a name="l00208"></a>00208           <a class="code" href="flFile_8c.html#bd15952bb98932926572c806c3b3cf20">fileRead</a>(tempModel-&gt;<a class="code" href="structModel3dAnimatedMD2.html#426ee1b3fd1199dcda98cc151f468749">md2Frames</a>[i].<a class="code" href="structmd2Frame.html#9c6ae978fdab67471b4541992f1e4664">md2FrameName</a>, 16, tempFile);
<a name="l00209"></a>00209           tempModel-&gt;<a class="code" href="structModel3dAnimatedMD2.html#426ee1b3fd1199dcda98cc151f468749">md2Frames</a>[i].<a class="code" href="structmd2Frame.html#39265296662b9ac977f63cef9315f3aa">md2FrameVerts</a> = (<a class="code" href="structmd2Vertex.html">md2Vertex</a>*)((u32)tempBlockAlloc + tempOffset);
<a name="l00210"></a>00210           tempOffset += (<span class="keyword">sizeof</span>(<a class="code" href="structmd2Vertex.html">md2Vertex</a>) * tempHeader.<a class="code" href="structmd2Header.html#9777ae802f1e96d5ac7c1e547b8aa65b">md2VertCount</a>);
<a name="l00211"></a>00211           <span class="keywordflow">for</span>(j = 0; j &lt; tempHeader.<a class="code" href="structmd2Header.html#9777ae802f1e96d5ac7c1e547b8aa65b">md2VertCount</a>; j++) {
<a name="l00212"></a>00212                <a class="code" href="flFile_8c.html#bd15952bb98932926572c806c3b3cf20">fileRead</a>(tempModel-&gt;<a class="code" href="structModel3dAnimatedMD2.html#426ee1b3fd1199dcda98cc151f468749">md2Frames</a>[i].<a class="code" href="structmd2Frame.html#39265296662b9ac977f63cef9315f3aa">md2FrameVerts</a>[j].<a class="code" href="structmd2Vertex.html#c8f2998d1d6d1296474ecebb1e20e6cf">md2VertexPos</a>, 3, tempFile);
<a name="l00213"></a>00213                <a class="code" href="flFile_8c.html#bd15952bb98932926572c806c3b3cf20">fileRead</a>(&amp;tempModel-&gt;<a class="code" href="structModel3dAnimatedMD2.html#426ee1b3fd1199dcda98cc151f468749">md2Frames</a>[i].<a class="code" href="structmd2Frame.html#39265296662b9ac977f63cef9315f3aa">md2FrameVerts</a>[j].<a class="code" href="structmd2Vertex.html#794120e53aeee52ef76807ca777d5b37">md2VertexNormal</a>, 1, tempFile);
<a name="l00214"></a>00214           }
<a name="l00215"></a>00215      }
<a name="l00216"></a>00216      
<a name="l00217"></a>00217      <a class="code" href="flFile_8c.html#bdd17f626a43391a546883c7a0544dc3">fileClose</a>(tempFile);
<a name="l00218"></a>00218      
<a name="l00219"></a>00219      <span class="keywordflow">return</span> tempOut;
<a name="l00220"></a>00220 }
<a name="l00221"></a>00221 
<a name="l00222"></a><a class="code" href="flModelMD2_8h.html#fe14c5983ff7ec31b62b50fc5c83eaf9">00222</a> <span class="keywordtype">void</span> <a class="code" href="flModelMD2_8c.html#fe14c5983ff7ec31b62b50fc5c83eaf9">mdl3dAnimDrawMD2</a>(<span class="keywordtype">void</span>* inModel, <span class="keywordtype">float</span> inFrame) {
<a name="l00223"></a>00223      <span class="keywordflow">if</span>(!inModel) {
<a name="l00224"></a>00224 <span class="preprocessor">          #if FL_DEBUG_WARNING != 0</span>
<a name="l00225"></a>00225 <span class="preprocessor"></span>          <a class="code" href="flDebug_8h.html#a122223db39f9f6ab0773adbf5de1a97">debugWarning</a>(<span class="stringliteral">"Trying to draw NULL md2."</span>);
<a name="l00226"></a>00226 <span class="preprocessor">          #endif</span>
<a name="l00227"></a>00227 <span class="preprocessor"></span>          <span class="keywordflow">return</span>;
<a name="l00228"></a>00228      }
<a name="l00229"></a>00229 
<a name="l00230"></a>00230      <a class="code" href="structModel3dAnimatedMD2.html">Model3dAnimatedMD2</a>* tempModel = (<a class="code" href="structModel3dAnimatedMD2.html">Model3dAnimatedMD2</a>*)inModel;
<a name="l00231"></a>00231 
<a name="l00232"></a>00232      <span class="keywordflow">while</span>(inFrame &gt;= (<span class="keywordtype">float</span>)tempModel-&gt;<a class="code" href="structModel3dAnimatedMD2.html#982b177f1e7eabc2eff5ff6dce05704e">md2FrameCount</a>)
<a name="l00233"></a>00233           inFrame -= (float)tempModel-&gt;<a class="code" href="structModel3dAnimatedMD2.html#982b177f1e7eabc2eff5ff6dce05704e">md2FrameCount</a>;
<a name="l00234"></a>00234      
<a name="l00235"></a>00235      <span class="keywordtype">int</span> tempFrames[2] = { (<span class="keywordtype">int</span>)inFrame, (int)(inFrame + 1.0f) };
<a name="l00236"></a>00236      <span class="keywordflow">if</span>(tempFrames[1] &gt;= tempModel-&gt;md2FrameCount)
<a name="l00237"></a>00237           tempFrames[1] -= tempModel-&gt;md2FrameCount;
<a name="l00238"></a>00238      <span class="keywordtype">float</span> tempFract = (inFrame - (float)tempFrames[0]);
<a name="l00239"></a>00239 
<a name="l00240"></a>00240      <a class="code" href="flTypes_8h.html#3a47c621e6f02f2c15ee0f9ac6a4c9a1">vect3f</a> tempScale = <a class="code" href="flTypes_8h.html#bbfdd6b9abb18c8ae319a1b633e7473a">vect3f_Mulf</a>(tempModel-&gt;md2Frames[tempFrames[0]].md2FrameScale, (1.0f - tempFract));
<a name="l00241"></a>00241      tempScale = <a class="code" href="flTypes_8h.html#84108eba3fe297a1cf5acf286aea7682">vect3f_Add</a>(tempScale, <a class="code" href="flTypes_8h.html#bbfdd6b9abb18c8ae319a1b633e7473a">vect3f_Mulf</a>(tempModel-&gt;md2Frames[tempFrames[1]].md2FrameScale, tempFract));
<a name="l00242"></a>00242      <a class="code" href="flTypes_8h.html#3a47c621e6f02f2c15ee0f9ac6a4c9a1">vect3f</a> tempTranslate = <a class="code" href="flTypes_8h.html#bbfdd6b9abb18c8ae319a1b633e7473a">vect3f_Mulf</a>(tempModel-&gt;md2Frames[tempFrames[0]].md2FrameTranslate, (1.0f - tempFract));
<a name="l00243"></a>00243      tempTranslate = <a class="code" href="flTypes_8h.html#84108eba3fe297a1cf5acf286aea7682">vect3f_Add</a>(tempTranslate, <a class="code" href="flTypes_8h.html#bbfdd6b9abb18c8ae319a1b633e7473a">vect3f_Mulf</a>(tempModel-&gt;md2Frames[tempFrames[1]].md2FrameTranslate, tempFract));
<a name="l00244"></a>00244 
<a name="l00245"></a>00245      <a class="code" href="flTexture_8c.html#83362b9a35e8267e6e24cc103e864cda">texBind</a>(tempModel-&gt;md2Textures[0]);
<a name="l00246"></a>00246 
<a name="l00247"></a>00247      sceGumPushMatrix();
<a name="l00248"></a>00248      sceGumScale(&amp;tempScale);
<a name="l00249"></a>00249      sceGumTranslate(&amp;tempTranslate);
<a name="l00250"></a>00250 
<a name="l00251"></a>00251      <span class="keywordtype">int</span> i, j;
<a name="l00252"></a>00252      <a class="code" href="structvertTsVf.html">vertTsVf</a>* tempVerts = (<a class="code" href="structvertTsVf.html">vertTsVf</a>*)sceGuGetMemory(<span class="keyword">sizeof</span>(<a class="code" href="structvertTsVf.html">vertTsVf</a>) * (tempModel-&gt;md2TriCount * 3));
<a name="l00253"></a>00253      <span class="keywordflow">for</span>(i = 0; i &lt; tempModel-&gt;md2TriCount; i++) {
<a name="l00254"></a>00254           <span class="keywordflow">for</span>(j = 0; j &lt; 3; j++) {
<a name="l00255"></a>00255                tempVerts[(i * 3) + j].vertX = (<span class="keywordtype">float</span>)tempModel-&gt;md2Frames[tempFrames[0]].md2FrameVerts[tempModel-&gt;md2Tris[i].md2TriVerts[j]].md2VertexPos[0] * (1.0f - tempFract);
<a name="l00256"></a>00256                tempVerts[(i * 3) + j].<a class="code" href="structvertTsVf.html#154bfa410aa44910ac19a7bbda885371">vertX</a> += (<span class="keywordtype">float</span>)tempModel-&gt;md2Frames[tempFrames[1]].md2FrameVerts[tempModel-&gt;md2Tris[i].md2TriVerts[j]].md2VertexPos[0] * tempFract;
<a name="l00257"></a>00257                tempVerts[(i * 3) + j].<a class="code" href="structvertTsVf.html#d323745ce38169f9951d4937b7526f5a">vertY</a> = (<span class="keywordtype">float</span>)tempModel-&gt;md2Frames[tempFrames[0]].md2FrameVerts[tempModel-&gt;md2Tris[i].md2TriVerts[j]].md2VertexPos[1] * (1.0f - tempFract);
<a name="l00258"></a>00258                tempVerts[(i * 3) + j].<a class="code" href="structvertTsVf.html#d323745ce38169f9951d4937b7526f5a">vertY</a> += (<span class="keywordtype">float</span>)tempModel-&gt;md2Frames[tempFrames[1]].md2FrameVerts[tempModel-&gt;md2Tris[i].md2TriVerts[j]].md2VertexPos[1] * tempFract;
<a name="l00259"></a>00259                tempVerts[(i * 3) + j].<a class="code" href="structvertTsVf.html#66ef3a5a24c0df4a2c902e029630a602">vertZ</a> = (<span class="keywordtype">float</span>)tempModel-&gt;md2Frames[tempFrames[0]].md2FrameVerts[tempModel-&gt;md2Tris[i].md2TriVerts[j]].md2VertexPos[2] * (1.0f - tempFract);
<a name="l00260"></a>00260                tempVerts[(i * 3) + j].<a class="code" href="structvertTsVf.html#66ef3a5a24c0df4a2c902e029630a602">vertZ</a> += (<span class="keywordtype">float</span>)tempModel-&gt;md2Frames[tempFrames[1]].md2FrameVerts[tempModel-&gt;md2Tris[i].md2TriVerts[j]].md2VertexPos[2] * tempFract;
<a name="l00261"></a>00261                tempVerts[(i * 3) + j].<a class="code" href="structvertTsVf.html#4f81e7cde272d6da4c52059918be807b">vertU</a> += tempModel-&gt;md2TexVerts[tempModel-&gt;md2Tris[i].md2TriTexVerts[j]].md2TexVertU;
<a name="l00262"></a>00262                tempVerts[(i * 3) + j].<a class="code" href="structvertTsVf.html#225184a2f5975b69e6dedec3ed4c196a">vertV</a> += tempModel-&gt;md2TexVerts[tempModel-&gt;md2Tris[i].md2TriTexVerts[j]].md2TexVertV;
<a name="l00263"></a>00263           }
<a name="l00264"></a>00264      }
<a name="l00265"></a>00265      sceGumDrawArray(GU_TRIANGLES, GU_TEXTURE_16BIT | GU_VERTEX_32BITF | GU_TRANSFORM_3D, (tempModel-&gt;md2TriCount * 3), 0, tempVerts);
<a name="l00266"></a>00266      sceGumPopMatrix();
<a name="l00267"></a>00267 }
<a name="l00268"></a>00268 
<a name="l00269"></a><a class="code" href="flModelMD2_8h.html#ea2d3e833bd2cf5916d1747a53e16012">00269</a> <span class="keywordtype">bool</span> <a class="code" href="flModelMD2_8c.html#ea2d3e833bd2cf5916d1747a53e16012">mdl3dAnimSaveMD2</a>(<span class="keywordtype">char</span>* inPath, <a class="code" href="structModel3dAnimated.html">Model3dAnimated</a>* inModel) {
<a name="l00270"></a>00270 <span class="preprocessor">     #if FL_DEBUG_DEVWARNING != 0</span>
<a name="l00271"></a>00271 <span class="preprocessor"></span>     <a class="code" href="flDebug_8h.html#d5943cf26301611cf94445fab201d878">debugDevWarning</a>(<span class="stringliteral">"MD2 saving is not yet implemented."</span>);
<a name="l00272"></a>00272 <span class="preprocessor">     #endif</span>
<a name="l00273"></a>00273 <span class="preprocessor"></span>     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00274"></a>00274 }
<a name="l00275"></a>00275 
<a name="l00276"></a>00276 <span class="preprocessor">#endif</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Sep 5 19:04:00 2007 for funcLib by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>
